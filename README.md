# Heart Failure Prediction API

A FastAPI-based web service for predicting heart failure death events using a trained machine learning model.

## Features

- RESTful API for heart failure predictions
- Request/Response validation using Pydantic
- Automatic model loading and scaling
- Health check endpoints
- Comprehensive error handling

## Project Structure

```
Student-Prediction/
├── app/
│   ├── __init__.py
│   ├── main.py              # FastAPI application
│   ├── models.py            # Pydantic request/response models
│   └── prediction.py        # Prediction service logic
├── Heart-Failure-Prediction.ipynb  # Training notebook
├── requirements.txt
├── .gitignore
└── README.md
```

## Setup

1. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

2. **Train and save the model:**
   - Run the Jupyter notebook `Heart-Failure-Prediction.ipynb`
   - This will generate `model.pkl` and `scaler.pkl` files

3. **Run the API:**
   ```bash
   uvicorn app.main:app --reload
   ```

   Or using Python:
   ```bash
   python -m app.main
   ```

4. **Access the API:**
   - API Documentation (Swagger UI): http://localhost:8000/docs
   - Alternative docs (ReDoc): http://localhost:8000/redoc
   - Health check: http://localhost:8000/health

## API Endpoints

### POST /predict
Predict heart failure death event based on patient features.

**Request Body:**
```json
{
  "age": 75.0,
  "anemia": 0,
  "creatinine_phosphokinase": 582,
  "diabetes": 0,
  "ejection_fraction": 20,
  "high_blood_pressure": 1,
  "platelets": 265000.00,
  "serum_creatinine": 1.9,
  "serum_sodium": 130,
  "sex": 1,
  "smoking": 0
}
```

**Response:**
```json
{
  "prediction": 1,
  "prediction_probability": 0.85,
  "message": "High risk of death event detected (probability: 85.00%)"
}
```

### GET /health
Health check endpoint to verify service status.

**Response:**
```json
{
  "status": "healthy",
  "message": "Service is operational and ready for predictions"
}
```

## Request Model Fields

- `age`: Age of the patient (0-120)
- `anemia`: Presence of anemia (0 or 1)
- `creatinine_phosphokinase`: Level of CPK enzyme in mcg/L
- `diabetes`: Presence of diabetes (0 or 1)
- `ejection_fraction`: Percentage of blood leaving heart (0-100)
- `high_blood_pressure`: Presence of high blood pressure (0 or 1)
- `platelets`: Platelets in blood (kiloplatelets/mL)
- `serum_creatinine`: Level of serum creatinine in mg/dL
- `serum_sodium`: Level of serum sodium in mEq/L
- `sex`: Sex of the patient (0 = female, 1 = male)
- `smoking`: Smoking status (0 or 1)

## Example Usage

### Using curl:
```bash
curl -X POST "http://localhost:8000/predict" \
  -H "Content-Type: application/json" \
  -d '{
    "age": 75.0,
    "anemia": 0,
    "creatinine_phosphokinase": 582,
    "diabetes": 0,
    "ejection_fraction": 20,
    "high_blood_pressure": 1,
    "platelets": 265000.00,
    "serum_creatinine": 1.9,
    "serum_sodium": 130,
    "sex": 1,
    "smoking": 0
  }'
```

### Using Python:
```python
import requests

url = "http://localhost:8000/predict"
data = {
    "age": 75.0,
    "anemia": 0,
    "creatinine_phosphokinase": 582,
    "diabetes": 0,
    "ejection_fraction": 20,
    "high_blood_pressure": 1,
    "platelets": 265000.00,
    "serum_creatinine": 1.9,
    "serum_sodium": 130,
    "sex": 1,
    "smoking": 0
}

response = requests.post(url, json=data)
print(response.json())
```

## Notes

- Make sure `model.pkl` and `scaler.pkl` files are in the root directory before running the API
- The model files are generated by running the Jupyter notebook
- For production deployment, configure CORS settings appropriately in `app/main.py`

